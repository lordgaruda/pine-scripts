//@version=5
indicator("EMA 200 + RSI 75 + Order Block Detector", overlay=true)

// === INPUTS ===
emaLength = input.int(200, title="EMA Length", minval=1)
rsiPeriod = input.int(14, title="RSI Period", minval=1)
rsiOverbought = input.int(75, title="RSI Overbought Level", minval=50, maxval=100)
orderBlockLookback = input.int(20, title="Order Block Lookback", minval=5)

// === PLOT EMA ===
ema200 = ta.ema(close, emaLength)
plot(ema200, title="200 EMA", color=color.blue, linewidth=2)

// === RSI CALCULATION ===
rsiValue = ta.rsi(close, rsiPeriod)
rsiOverboughtSignal = ta.crossover(rsiValue, rsiOverbought)
rsiOverboughtAlert = ta.crossunder(rsiValue, rsiOverbought)

// Plot RSI signals on chart
plotshape(rsiOverboughtSignal, title="RSI Overbought Signal", location=location.abovebar, color=color.red, style=shape.triangledown, size=size.small)
plotshape(rsiOverboughtAlert, title="RSI Overbought Alert", location=location.abovebar, color=color.green, style=shape.triangleup, size=size.small)

// === ORDER BLOCK DETECTION ===
// Find swing highs and swing lows within the lookback period
swingHigh = ta.highest(high, orderBlockLookback)
swingLow = ta.lowest(low, orderBlockLookback)

// Plot order block zones for swing highs (potential supply)
orderBlockHigh = ta.valuewhen(high == swingHigh, high, 0)
plotshape(high == swingHigh, title="Order Block High", location=location.abovebar, color=color.orange, style=shape.diamond, size=size.small)

// Plot order block zones for swing lows (potential demand)
orderBlockLow = ta.valuewhen(low == swingLow, low, 0)
plotshape(low == swingLow, title="Order Block Low", location=location.belowbar, color=color.lime, style=shape.diamond, size=size.small)

// === ALERTS ===
alertcondition(rsiOverboughtSignal, title="RSI Crossed Above 75", message="RSI has crossed above 75!")
alertcondition(rsiOverboughtAlert, title="RSI Crossed Below 75", message="RSI has crossed below 75!")
